# 1. 지하철 데이터 분석 과정

## fifth.parquet
* 내용 : 코로나 이후 2020년~2021년까지의 요일에 따른 지하철역 시간대별 승하차 인원 수를 기록한 데이터
* 과정
    ### 1. 데이터 병합
    * 원본데이터는 2020년과 2021년 일별 시간대별로 되어 있는 csv파일로 이루어져 있음. (2개의 csv파일)

        [출처] https://data.seoul.go.kr/
    * 파이썬 라이브러리인 glob 모듈을 이용하여 csv를 합침.
    * 합치는 과정에서 시간대별 컬럼명이 달라서 2021년의 컬럼명을 기준으로 컬럼명을 맞춰주었음.

    ### 2. 데이터 전처리
    * 필요한 컬럼 : "호선","역명","요일","구분","각 시간대" 컬럼이 필요함.
    * 데이터 타입 변환 : 날짜를 datetime으로 변환.
    <!--table-->
    |날짜|시간대|
    |:--:|:--:|
    |date|int|

    * 컬럼값 제거 : 2020년 1월20일에 코로나 첫 확진자가 발생하였으므로 이전 데이터들 제거
    * 요일 컬럼 생성 : 날짜가 일별로 되어 있으므로 dt.day_name()을 이용하여 요일을 나타냄.
    * 공휴일 컬럼 생성 : "공휴일" 컬럼은 파이썬 모듈인 holidays를 이용하여 공휴일이면 "holiday", 공휴일이 아니면 "non-holiday"라고 나타냄.
    * 역명 이름 변경 : 역이름이 통일이 안된 것이 있으므로, 역의 이름을 통일시켜 주고자 딕셔너리를 생성하여 역명을 변경시켜줌.

    ### 3. 데이터 분석과정
    * 분석방법 : 전처리한 데이터를 가지고 평일 데이터프레임과 공휴일 데이터를 각각 만들어 준 후 concat을 아용해 합침.

    (1) 평일 데이터프레임 생성 : 토요일과 일요일과 공휴일을 제거한 평일만 들어있는 데이터 프레임을 생성.

    (2) "호선","역명","요일","구분" 컬럼을 기준으로 그룹화한 후 정렬하기. (정렬할 때 문자형으로 정렬되는 특이사항 발생)

    (3) 공휴일 데이터프레임 생성 : 토요일과 일요일과 공휴일만 해당하는 공휴일 데이터프레임 생성.

    (4) 정렬은 평일 데이터프레임과 같은 방법으로 진행.

    (5) 평일과 공휴일 데이터프레임 병합 : 평일과 공휴일 데이터프레임을 합쳐야하니 공휴일 데이터프레임에 있는 요일들을 "holiday"라고 설정을 한 후 평일 데이터프레임과 합치기.

    * 예시
    <!--table-->
    |호선|역명|요일|구분|06:00 이전|06:00 ~ 07:00|07:00 ~ 08:00|08:00 ~ 09:00|09:00 ~ 10:00|10:00 ~ 11:00	|11:00 ~ 12:00|12:00 ~ 13:00|13:00 ~ 14:00|14:00 ~ 15:00|15:00 ~ 16:00|16:00 ~ 17:00|17:00 ~ 18:00|18:00 ~ 19:00|19:00 ~ 20:00|20:00 ~ 21:00|21:00 ~ 22:00|22:00 ~ 23:00|	23:00 이후|
    |:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
    |string|string|category|string|float|float|float|float|float|float|float|float|float|float|float|float|float|float|float|float|float|float|float|
    |호선|동대문|Monday|승차|485.0|329.0|523.0|682.0|583.0|501.0|...|...|...|671.0|	700.0|740.0|782.0|814.0|546.0|420.0|396.0|310.0|124.0|
    
    ### 4. 특이사항
    * 역명이 일치하지 않아 태블로에 역 좌표를 찍을 때 그 데이터가 나타나지 않는 현상이 발생.
    (1) 데이터에는 있고 좌표에는 없는 역
    * 5호선(신설역) : 강일, 미사, 하남검단산, 하남시청(덕풍·신장),하남풍산
    * 6호선(신설역) : 신내
    
    (2) 데이터에는 없고 좌표에는 있는 역 
    * 3호선(일산선) : 대곡, 대화, 마두, 백석, 삼송, 원당, 정발산, 주엽, 화정
    * 4호선(과천선) : 경마공원, 과천, 범계, 선바위, 인덕원, 정부과천청사, 평촌
    * 4호선(안산선) : 고잔, 금정,  대야미, 산본, 상록수, 수리산, 신길온천, 안산, 오이도, 정왕,  중앙, 초지, 한대앞
    
    (3) 1호선은 동대문, 동묘앞, 서울역, 시청, 신설동, 제기동, 종각, 종로3가, 종로5가, 청량리역만 존재함.(총 10개)

    해결 : 좌표를 기준을 잡아야하므로 좌표에 있는 역들과 가지고 있는 데이터의 역들을 변경하거나 제거하여 일치 시켜줘야함. 그러므로 (1)번은 좌표에 없으므로 놔두고, (2)번은 좌표를 제거해주고, (3)번만 바꿔주었음.

    * 요일을 정렬하려고 하는데 요일이 string 타입이라서 가,나,다로 알파벳 순서대로 정렬되는 것이 확인됨. 

    해결 : 파이썬 모듈인 CategoricalDtype을 이용하여 요일을 월요일 순서대로 정렬하도록 설정하였더니 요일별로 정렬됨을 확인함.
____
___
